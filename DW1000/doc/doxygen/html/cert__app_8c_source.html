<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>third_party/mbedtls/repo/programs/x509/cert_app.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Open-Thread-Logo-200x42.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">CLI and NCP Application</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_44f42edf5dd23d4deca0321224e9ce90.html">third_party</a></li><li class="navelem"><a class="el" href="dir_2c3d6607fdac3e9186e98b5e2f588509.html">mbedtls</a></li><li class="navelem"><a class="el" href="dir_2dc104378b4059f668847b2a8b47063b.html">repo</a></li><li class="navelem"><a class="el" href="dir_56672f937ec54928cff4eb4c52e260b9.html">programs</a></li><li class="navelem"><a class="el" href="dir_3763c1db7b13e09bfd4174f9d8d48155.html">x509</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cert_app.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cert__app_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  Certificate reading application</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  not use this file except in compliance with the License.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  You may obtain a copy of the License at</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  limitations under the License.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *  This file is part of mbed TLS (https://tls.mbed.org)</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#if !defined(MBEDTLS_CONFIG_FILE)</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8h.html">mbedtls/config.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include MBEDTLS_CONFIG_FILE</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PLATFORM_C)</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="third__party_2mbedtls_2repo_2include_2mbedtls_2platform_8h.html">mbedtls/platform.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="cert__app_8c.html#a85fcfc46e7a73613d58f5aa698226a96">   33</a></span>&#160;<span class="preprocessor">#define mbedtls_time       time</span></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="cert__app_8c.html#ab31374c1eadaa818b832ffef65db5389">   34</a></span>&#160;<span class="preprocessor">#define mbedtls_time_t     time_t</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="cert__app_8c.html#a6d045f0c3699e1eac7f723054dc8b3e4">   35</a></span>&#160;<span class="preprocessor">#define mbedtls_fprintf    fprintf</span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">   36</a></span>&#160;<span class="preprocessor">#define mbedtls_printf     printf</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#if !defined(MBEDTLS_BIGNUM_C) || !defined(MBEDTLS_ENTROPY_C) ||  \</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_SSL_TLS_C) || !defined(MBEDTLS_SSL_CLI_C) || \</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_NET_C) || !defined(MBEDTLS_RSA_C) ||         \</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_X509_CRT_PARSE_C) || !defined(MBEDTLS_FS_IO) ||  \</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_CTR_DRBG_C)</span></div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="cert__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe">   44</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="cert__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>( <span class="keywordtype">void</span> )</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>(<span class="stringliteral">&quot;MBEDTLS_BIGNUM_C and/or MBEDTLS_ENTROPY_C and/or &quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;           <span class="stringliteral">&quot;MBEDTLS_SSL_TLS_C and/or MBEDTLS_SSL_CLI_C and/or &quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;           <span class="stringliteral">&quot;MBEDTLS_NET_C and/or MBEDTLS_RSA_C and/or &quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;           <span class="stringliteral">&quot;MBEDTLS_X509_CRT_PARSE_C and/or MBEDTLS_FS_IO and/or &quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;           <span class="stringliteral">&quot;MBEDTLS_CTR_DRBG_C not defined.\n&quot;</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="entropy_8h.html">mbedtls/entropy.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ctr__drbg_8h.html">mbedtls/ctr_drbg.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="net__sockets_8h.html">mbedtls/net_sockets.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ssl_8h.html">mbedtls/ssl.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="x509_8h.html">mbedtls/x509.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mbedtls_2repo_2include_2mbedtls_2debug_8h.html">mbedtls/debug.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#define MODE_NONE               0</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#define MODE_FILE               1</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#define MODE_SSL                2</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#define DFL_MODE                MODE_NONE</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#define DFL_FILENAME            &quot;cert.crt&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#define DFL_CA_FILE             &quot;&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#define DFL_CRL_FILE            &quot;&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#define DFL_CA_PATH             &quot;&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#define DFL_SERVER_NAME         &quot;localhost&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#define DFL_SERVER_PORT         &quot;4433&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#define DFL_DEBUG_LEVEL         0</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#define DFL_PERMISSIVE          0</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#define USAGE_IO \</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">    &quot;    ca_file=%%s          The single file containing the top-level CA(s) you fully trust\n&quot; \</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">    &quot;                        default: \&quot;\&quot; (none)\n&quot; \</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">    &quot;    crl_file=%%s         The single CRL file you want to use\n&quot; \</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">    &quot;                        default: \&quot;\&quot; (none)\n&quot; \</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">    &quot;    ca_path=%%s          The path containing the top-level CA(s) you fully trust\n&quot; \</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">    &quot;                        default: \&quot;\&quot; (none) (overrides ca_file)\n&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#define USAGE \</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">    &quot;\n usage: cert_app param=&lt;&gt;...\n&quot;                  \</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">    &quot;\n acceptable parameters:\n&quot;                       \</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">    &quot;    mode=file|ssl       default: none\n&quot;           \</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">    &quot;    filename=%%s         default: cert.crt\n&quot;      \</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">    USAGE_IO                                            \</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">    &quot;    server_name=%%s      default: localhost\n&quot;     \</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">    &quot;    server_port=%%d      default: 4433\n&quot;          \</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">    &quot;    debug_level=%%d      default: 0 (disabled)\n&quot;  \</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">    &quot;    permissive=%%d       default: 0 (disabled)\n&quot;  \</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">    &quot;\n&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> * global options</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">struct </span>options</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">int</span> mode;                   <span class="comment">/* the mode to run the application in   */</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacegencsv.html#a3a1a90139c2c8ab1fca0ea8b1790b7b2">filename</a>;       <span class="comment">/* filename of the certificate file     */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *ca_file;        <span class="comment">/* the file with the CA certificate(s)  */</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *crl_file;       <span class="comment">/* the file with the CRL to use         */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *ca_path;        <span class="comment">/* the path with the CA certificate(s) reside */</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *server_name;    <span class="comment">/* hostname of the server (client only) */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *server_port;    <span class="comment">/* port on which the ssl service runs   */</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">int</span> debug_level;            <span class="comment">/* level of debugging                   */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">int</span> permissive;             <span class="comment">/* permissive parsing                   */</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;} opt;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> my_debug( <span class="keywordtype">void</span> *ctx, <span class="keywordtype">int</span> <a class="code" href="namespaceautothreadharness_1_1runner.html#afde8e18a788ccc92fc61cab298bca7e3">level</a>,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *file, <span class="keywordtype">int</span> line,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *str )</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;{</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ((void) level);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="cert__app_8c.html#a6d045f0c3699e1eac7f723054dc8b3e4">mbedtls_fprintf</a>( (FILE *) ctx, <span class="stringliteral">&quot;%s:%04d: %s&quot;</span>, file, line, str );</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    fflush(  (FILE *) ctx  );</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> my_verify( <span class="keywordtype">void</span> *data, <a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a> *crt, <span class="keywordtype">int</span> depth, <a class="code" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *flags )</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    ((void) data);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;\nVerify requested for (Depth %d):\n&quot;</span>, depth );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="group__x509__module.html#gabaf30f2269fc3b6608b25871f9d09da6">mbedtls_x509_crt_info</a>( buf, <span class="keyword">sizeof</span>( buf ) - 1, <span class="stringliteral">&quot;&quot;</span>, crt );</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;%s&quot;</span>, buf );</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> ( ( *flags ) == 0 )</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  This certificate has no flags\n&quot;</span> );</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="group__x509__module.html#gae88f1d8e6696eb2beeffe0a708219e6b">mbedtls_x509_crt_verify_info</a>( buf, <span class="keyword">sizeof</span>( buf ), <span class="stringliteral">&quot;  ! &quot;</span>, *flags );</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;%s\n&quot;</span>, buf );</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">int</span> <a class="code" href="cert__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[] )</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="structmbedtls__net__context.html">mbedtls_net_context</a> server_fd;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="structmbedtls__entropy__context.html">mbedtls_entropy_context</a> entropy;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="structmbedtls__ctr__drbg__context.html">mbedtls_ctr_drbg_context</a> ctr_drbg;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="structmbedtls__ssl__context.html">mbedtls_ssl_context</a> ssl;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="structmbedtls__ssl__config.html">mbedtls_ssl_config</a> <a class="code" href="namespaceconf.html">conf</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a> cacert;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="structmbedtls__x509__crl.html">mbedtls_x509_crl</a> cacrl;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">int</span> i, j;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> flags;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">int</span> verify = 0;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">char</span> *p, *q;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pers = <span class="stringliteral">&quot;cert_app&quot;</span>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">     * Set to sane values</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="net__sockets_8h.html#aed7458e19fc1b4794f3a23aa3df49543">mbedtls_net_init</a>( &amp;server_fd );</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="ctr__drbg_8h.html#a70dbec5e03601bf437ec488f2645743b">mbedtls_ctr_drbg_init</a>( &amp;ctr_drbg );</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="ssl_8h.html#a8560dea66d7830a11874188727ec4c45">mbedtls_ssl_init</a>( &amp;ssl );</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="ssl_8h.html#aba55bcda50a47e83803e31a8db7c9a86">mbedtls_ssl_config_init</a>( &amp;conf );</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a>( &amp;cacert );</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CRL_PARSE_C)</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="group__x509__module.html#ga8513a192e281217802837571da98e218">mbedtls_x509_crl_init</a>( &amp;cacrl );</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">/* Zeroize structure as CRL parsing is not supported and we have to pass</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">       it to the verify function */</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    memset( &amp;cacrl, 0, <span class="keyword">sizeof</span>(<a class="code" href="structmbedtls__x509__crl.html">mbedtls_x509_crl</a>) );</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span>( argc == 0 )</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    usage:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <a class="code" href="aescrypt2_8c.html#a56fe9bff0a1be75aae2da3e593053e2c">USAGE</a> );</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        ret = 2;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    opt.mode                = <a class="code" href="key__app_8c.html#a15d65445a8255b32e162d892f6627851">DFL_MODE</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    opt.filename            = <a class="code" href="gen__key_8c.html#ae388645a5cd32468957368966fa554f1">DFL_FILENAME</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    opt.ca_file             = DFL_CA_FILE;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    opt.crl_file            = DFL_CRL_FILE;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    opt.ca_path             = DFL_CA_PATH;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    opt.server_name         = DFL_SERVER_NAME;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    opt.server_port         = DFL_SERVER_PORT;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    opt.debug_level         = <a class="code" href="key__app_8c.html#a5788fa2aa47c6468f29c31c2bd7d7488">DFL_DEBUG_LEVEL</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    opt.permissive          = DFL_PERMISSIVE;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">for</span>( i = 1; i &lt; argc; i++ )</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        p = argv[i];</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span>( ( q = strchr( p, <span class="charliteral">&#39;=&#39;</span> ) ) == <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        *q++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">for</span>( j = 0; p + j &lt; q; j++ )</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">if</span>( argv[i][j] &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; argv[i][j] &lt;= <span class="charliteral">&#39;Z&#39;</span> )</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                argv[i][j] |= 0x20;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;mode&quot;</span> ) == 0 )</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;file&quot;</span> ) == 0 )</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                opt.mode = MODE_FILE;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;ssl&quot;</span> ) == 0 )</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                opt.mode = MODE_SSL;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;filename&quot;</span> ) == 0 )</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            opt.filename = q;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;ca_file&quot;</span> ) == 0 )</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            opt.ca_file = q;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;crl_file&quot;</span> ) == 0 )</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            opt.crl_file = q;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;ca_path&quot;</span> ) == 0 )</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            opt.ca_path = q;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;server_name&quot;</span> ) == 0 )</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            opt.server_name = q;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;server_port&quot;</span> ) == 0 )</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            opt.server_port = q;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;debug_level&quot;</span> ) == 0 )</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            opt.debug_level = atoi( q );</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">if</span>( opt.debug_level &lt; 0 || opt.debug_level &gt; 65535 )</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;permissive&quot;</span> ) == 0 )</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            opt.permissive = atoi( q );</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span>( opt.permissive &lt; 0 || opt.permissive &gt; 1 )</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">     * 1.1. Load the trusted CA</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Loading the CA root certificate ...&quot;</span> );</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span>( strlen( opt.ca_path ) )</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        ret = <a class="code" href="group__x509__module.html#ga571fc89b9f3217ab3dd67bd7af905066">mbedtls_x509_crt_parse_path</a>( &amp;cacert, opt.ca_path );</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        verify = 1;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strlen( opt.ca_file ) )</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        ret = <a class="code" href="group__x509__module.html#gad4da63133d3590aa311488497d4c38ec">mbedtls_x509_crt_parse_file</a>( &amp;cacert, opt.ca_file );</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        verify = 1;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span>( ret &lt; 0 )</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_crt_parse returned -0x%x\n\n&quot;</span>, -ret );</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok (%d skipped)\n&quot;</span>, ret );</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CRL_PARSE_C)</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">if</span>( strlen( opt.crl_file ) )</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="group__x509__module.html#ga8e096827f1240b8f8bc15d6a83593f22">mbedtls_x509_crl_parse_file</a>( &amp;cacrl, opt.crl_file ) ) != 0 )</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_crl_parse returned -0x%x\n\n&quot;</span>, -ret );</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        verify = 1;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span>( opt.mode == MODE_FILE )</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a> crt;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a> *cur = &amp;crt;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a>( &amp;crt );</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">         * 1.1. Load the certificate(s)</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;\n  . Loading the certificate(s) ...&quot;</span> );</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        ret = <a class="code" href="group__x509__module.html#gad4da63133d3590aa311488497d4c38ec">mbedtls_x509_crt_parse_file</a>( &amp;crt, opt.filename );</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span>( ret &lt; 0 )</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_crt_parse_file returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <a class="code" href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a>( &amp;crt );</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span>( opt.permissive == 0 &amp;&amp; ret &gt; 0 )</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_crt_parse failed to parse %d certificates\n\n&quot;</span>, ret );</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a>( &amp;crt );</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">         * 1.2 Print the certificate(s)</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">while</span>( cur != <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Peer certificate information    ...\n&quot;</span> );</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            ret = <a class="code" href="group__x509__module.html#gabaf30f2269fc3b6608b25871f9d09da6">mbedtls_x509_crt_info</a>( (<span class="keywordtype">char</span> *) buf, <span class="keyword">sizeof</span>( buf ) - 1, <span class="stringliteral">&quot;      &quot;</span>,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                 cur );</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span>( ret == -1 )</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_crt_info returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <a class="code" href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a>( &amp;crt );</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;%s\n&quot;</span>, buf );</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            cur = cur-&gt;<a class="code" href="structmbedtls__x509__crt.html#acb677316e4c036e738ed05833f222f5a">next</a>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        ret = 0;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">         * 1.3 Verify the certificate</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span>( verify )</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Verifying X.509 certificate...&quot;</span> );</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">if</span>( ( ret = <a class="code" href="group__x509__module.html#ga98ed4504e4f832b735a230acf54fcde3">mbedtls_x509_crt_verify</a>( &amp;crt, &amp;cacert, &amp;cacrl, <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;flags,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                         my_verify, <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) ) != 0 )</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordtype">char</span> vrfy_buf[512];</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n&quot;</span> );</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <a class="code" href="group__x509__module.html#gae88f1d8e6696eb2beeffe0a708219e6b">mbedtls_x509_crt_verify_info</a>( vrfy_buf, <span class="keyword">sizeof</span>( vrfy_buf ), <span class="stringliteral">&quot;  ! &quot;</span>, flags );</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;%s\n&quot;</span>, vrfy_buf );</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a>( &amp;crt );</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( opt.mode == MODE_SSL )</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">         * 1. Initialize the RNG and the session data</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;\n  . Seeding the random number generator...&quot;</span> );</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="entropy_8h.html#aa901e027093c6fe65dee5760db78aced">mbedtls_entropy_init</a>( &amp;entropy );</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="ctr__drbg_8h.html#ad93d675f998550b4478c1fe6f4f34ebc">mbedtls_ctr_drbg_seed</a>( &amp;ctr_drbg, <a class="code" href="entropy_8h.html#a81765f6cdf4e5111bcb9f4324f3234cb">mbedtls_entropy_func</a>, &amp;entropy,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                   (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) pers,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                   strlen( pers ) ) ) != 0 )</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  ! mbedtls_ctr_drbg_seed returned %d\n&quot;</span>, ret );</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keywordflow">goto</span> ssl_exit;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_DEBUG_C)</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="mbedtls_2repo_2include_2mbedtls_2debug_8h.html#a6629362e96b43725ace95c8ff01d9985">mbedtls_debug_set_threshold</a>( opt.debug_level );</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">         * 2. Start the connection</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . SSL connection to tcp/%s/%s...&quot;</span>, opt.server_name,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                                              opt.server_port );</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="net__sockets_8h.html#ac12c400864a5aad46666828ce2a089a4">mbedtls_net_connect</a>( &amp;server_fd, opt.server_name,</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                 opt.server_port, <a class="code" href="net__sockets_8h.html#a989e1bc1aae7e48ac318d5ddd24efa3b">MBEDTLS_NET_PROTO_TCP</a> ) ) != 0 )</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  ! mbedtls_net_connect returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">goto</span> ssl_exit;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">         * 3. Setup stuff</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="ssl_8h.html#aa1335b65ba57e81accc91ef95454d5a6">mbedtls_ssl_config_defaults</a>( &amp;conf,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        <a class="code" href="ssl_8h.html#a2064e7d9ad950b5979d2d6bab6ddc739">MBEDTLS_SSL_IS_CLIENT</a>,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        <a class="code" href="ssl_8h.html#acf690cf4772ff3e2df4b8295275e6fc7">MBEDTLS_SSL_TRANSPORT_STREAM</a>,</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        <a class="code" href="ssl_8h.html#afb44a7bdf71d0a1472db0c70596599cb">MBEDTLS_SSL_PRESET_DEFAULT</a> ) ) != 0 )</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  ! mbedtls_ssl_config_defaults returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span>( verify )</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <a class="code" href="ssl_8h.html#a5695285c9dbfefec295012b566290f37">mbedtls_ssl_conf_authmode</a>( &amp;conf, <a class="code" href="ssl_8h.html#acc9ad7a06d7c65260e815a3187a5fb37">MBEDTLS_SSL_VERIFY_REQUIRED</a> );</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <a class="code" href="ssl_8h.html#a85c3bb6b682ba361d13de1c0a1eb69fb">mbedtls_ssl_conf_ca_chain</a>( &amp;conf, &amp;cacert, <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> );</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <a class="code" href="ssl_8h.html#afc2b6b55d7ccaf38d84a4fbf1655f426">mbedtls_ssl_conf_verify</a>( &amp;conf, my_verify, <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> );</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <a class="code" href="ssl_8h.html#a5695285c9dbfefec295012b566290f37">mbedtls_ssl_conf_authmode</a>( &amp;conf, <a class="code" href="ssl_8h.html#a1976b5c76af7b8b8f76c6f302828b387">MBEDTLS_SSL_VERIFY_NONE</a> );</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <a class="code" href="ssl_8h.html#a469cd1c64bbba4be22347bf8874a017e">mbedtls_ssl_conf_rng</a>( &amp;conf, <a class="code" href="ctr__drbg_8h.html#af6e4dd295ae790a33128562dd01c79ab">mbedtls_ctr_drbg_random</a>, &amp;ctr_drbg );</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="ssl_8h.html#ab15dcbe7c7fe2a5c118e7c486c07c921">mbedtls_ssl_conf_dbg</a>( &amp;conf, my_debug, stdout );</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="ssl_8h.html#af79cb539a0ee6ac20cf9c574f4c3b343">mbedtls_ssl_setup</a>( &amp;ssl, &amp;conf ) ) != 0 )</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  ! mbedtls_ssl_setup returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordflow">goto</span> ssl_exit;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="ssl_8h.html#aa659024cf89e20d6d2248c0626db7ef2">mbedtls_ssl_set_hostname</a>( &amp;ssl, opt.server_name ) ) != 0 )</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  ! mbedtls_ssl_set_hostname returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">goto</span> ssl_exit;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="ssl_8h.html#a8b7442420aef7f1a76fa8c5336362f9e">mbedtls_ssl_set_bio</a>( &amp;ssl, &amp;server_fd, <a class="code" href="net__sockets_8h.html#a4841afd0e14f1fd44b82c3a850961ab7">mbedtls_net_send</a>, <a class="code" href="net__sockets_8h.html#a03af351ec420bbeb5e91357abcfb3663">mbedtls_net_recv</a>, <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> );</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">         * 4. Handshake</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">while</span>( ( ret = <a class="code" href="ssl_8h.html#a4a37e497cd08c896870a42b1b618186e">mbedtls_ssl_handshake</a>( &amp;ssl ) ) != 0 )</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">if</span>( ret != <a class="code" href="ssl_8h.html#a67a1e093cf042831aa60bb567915b560">MBEDTLS_ERR_SSL_WANT_READ</a> &amp;&amp; ret != <a class="code" href="ssl_8h.html#a674bde213fbbf602e04bbc131dd2dc33">MBEDTLS_ERR_SSL_WANT_WRITE</a> )</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  ! mbedtls_ssl_handshake returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="keywordflow">goto</span> ssl_exit;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">         * 5. Print the certificate</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Peer certificate information    ...\n&quot;</span> );</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        ret = <a class="code" href="group__x509__module.html#gabaf30f2269fc3b6608b25871f9d09da6">mbedtls_x509_crt_info</a>( (<span class="keywordtype">char</span> *) buf, <span class="keyword">sizeof</span>( buf ) - 1, <span class="stringliteral">&quot;      &quot;</span>,</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                             ssl.<a class="code" href="structmbedtls__ssl__context.html#ad8989c71f35c1c4aabf310f27fcca131">session</a>-&gt;<a class="code" href="structmbedtls__ssl__session.html#a47c7a9c3ca501024650129c095a5ce3e">peer_cert</a> );</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">if</span>( ret == -1 )</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_crt_info returned %d\n\n&quot;</span>, ret );</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">goto</span> ssl_exit;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;%s\n&quot;</span>, buf );</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="ssl_8h.html#ac2c1b17128ead2df3082e27b603deb4c">mbedtls_ssl_close_notify</a>( &amp;ssl );</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;ssl_exit:</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="ssl_8h.html#a2dc104a181bcd11eafbbf7e6923978bc">mbedtls_ssl_free</a>( &amp;ssl );</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="ssl_8h.html#a7655f025440a6c5ccd4fc13832abb1dd">mbedtls_ssl_config_free</a>( &amp;conf );</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;exit:</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="net__sockets_8h.html#a77c35cb3f4b9fe6035d1d3742f3b4a24">mbedtls_net_free</a>( &amp;server_fd );</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a>( &amp;cacert );</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CRL_PARSE_C)</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="group__x509__module.html#gaeb19c3326889f9e493fbd605c1113b96">mbedtls_x509_crl_free</a>( &amp;cacrl );</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="ctr__drbg_8h.html#a1ea42b9eb6f6b33c82359f4c0a57ca43">mbedtls_ctr_drbg_free</a>( &amp;ctr_drbg );</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="entropy_8h.html#a06778439f8a0e2daa2d3b444e06ad8dd">mbedtls_entropy_free</a>( &amp;entropy );</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  + Press Enter to exit this program.\n&quot;</span> );</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    fflush( stdout ); getchar();</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span>( ret &lt; 0 )</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        ret = 1;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_BIGNUM_C &amp;&amp; MBEDTLS_ENTROPY_C &amp;&amp; MBEDTLS_SSL_TLS_C &amp;&amp;</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">          MBEDTLS_SSL_CLI_C &amp;&amp; MBEDTLS_NET_C &amp;&amp; MBEDTLS_RSA_C &amp;&amp;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">          MBEDTLS_X509_CRT_PARSE_C &amp;&amp; MBEDTLS_FS_IO &amp;&amp; MBEDTLS_CTR_DRBG_C */</span><span class="preprocessor"></span></div><div class="ttc" id="group__x509__module_html_ga98ed4504e4f832b735a230acf54fcde3"><div class="ttname"><a href="group__x509__module.html#ga98ed4504e4f832b735a230acf54fcde3">mbedtls_x509_crt_verify</a></div><div class="ttdeci">int mbedtls_x509_crt_verify(mbedtls_x509_crt *crt, mbedtls_x509_crt *trust_ca, mbedtls_x509_crl *ca_crl, const char *cn, uint32_t *flags, int(*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *), void *p_vrfy)</div><div class="ttdoc">Verify the certificate signature. </div></div>
<div class="ttc" id="structmbedtls__ctr__drbg__context_html"><div class="ttname"><a href="structmbedtls__ctr__drbg__context.html">mbedtls_ctr_drbg_context</a></div><div class="ttdoc">CTR_DRBG context structure. </div><div class="ttdef"><b>Definition:</b> <a href="ctr__drbg_8h_source.html#l00087">ctr_drbg.h:87</a></div></div>
<div class="ttc" id="namespaceautothreadharness_1_1runner_html_afde8e18a788ccc92fc61cab298bca7e3"><div class="ttname"><a href="namespaceautothreadharness_1_1runner.html#afde8e18a788ccc92fc61cab298bca7e3">autothreadharness.runner.level</a></div><div class="ttdeci">level</div><div class="ttdef"><b>Definition:</b> <a href="runner_8py_source.html#l00045">runner.py:45</a></div></div>
<div class="ttc" id="aescrypt2_8c_html_a56fe9bff0a1be75aae2da3e593053e2c"><div class="ttname"><a href="aescrypt2_8c.html#a56fe9bff0a1be75aae2da3e593053e2c">USAGE</a></div><div class="ttdeci">#define USAGE</div><div class="ttdef"><b>Definition:</b> <a href="aescrypt2_8c_source.html#l00056">aescrypt2.c:56</a></div></div>
<div class="ttc" id="net__sockets_8h_html_a989e1bc1aae7e48ac318d5ddd24efa3b"><div class="ttname"><a href="net__sockets_8h.html#a989e1bc1aae7e48ac318d5ddd24efa3b">MBEDTLS_NET_PROTO_TCP</a></div><div class="ttdeci">#define MBEDTLS_NET_PROTO_TCP</div><div class="ttdef"><b>Definition:</b> <a href="net__sockets_8h_source.html#l00051">net_sockets.h:51</a></div></div>
<div class="ttc" id="structmbedtls__ssl__context_html_ad8989c71f35c1c4aabf310f27fcca131"><div class="ttname"><a href="structmbedtls__ssl__context.html#ad8989c71f35c1c4aabf310f27fcca131">mbedtls_ssl_context::session</a></div><div class="ttdeci">mbedtls_ssl_session * session</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00789">ssl.h:789</a></div></div>
<div class="ttc" id="ssl_8h_html_a1976b5c76af7b8b8f76c6f302828b387"><div class="ttname"><a href="ssl_8h.html#a1976b5c76af7b8b8f76c6f302828b387">MBEDTLS_SSL_VERIFY_NONE</a></div><div class="ttdeci">#define MBEDTLS_SSL_VERIFY_NONE</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00151">ssl.h:151</a></div></div>
<div class="ttc" id="ctr__drbg_8h_html_a1ea42b9eb6f6b33c82359f4c0a57ca43"><div class="ttname"><a href="ctr__drbg_8h.html#a1ea42b9eb6f6b33c82359f4c0a57ca43">mbedtls_ctr_drbg_free</a></div><div class="ttdeci">void mbedtls_ctr_drbg_free(mbedtls_ctr_drbg_context *ctx)</div><div class="ttdoc">Clear CTR_CRBG context data. </div></div>
<div class="ttc" id="cert__app_8c_html_af846397815d6b78aadc6ce9bb6bc9238"><div class="ttname"><a href="cert__app_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a></div><div class="ttdeci">#define mbedtls_printf</div><div class="ttdef"><b>Definition:</b> <a href="cert__app_8c_source.html#l00036">cert_app.c:36</a></div></div>
<div class="ttc" id="gen__key_8c_html_ae388645a5cd32468957368966fa554f1"><div class="ttname"><a href="gen__key_8c.html#ae388645a5cd32468957368966fa554f1">DFL_FILENAME</a></div><div class="ttdeci">#define DFL_FILENAME</div><div class="ttdef"><b>Definition:</b> <a href="gen__key_8c_source.html#l00108">gen_key.c:108</a></div></div>
<div class="ttc" id="net__sockets_8h_html_a77c35cb3f4b9fe6035d1d3742f3b4a24"><div class="ttname"><a href="net__sockets_8h.html#a77c35cb3f4b9fe6035d1d3742f3b4a24">mbedtls_net_free</a></div><div class="ttdeci">void mbedtls_net_free(mbedtls_net_context *ctx)</div><div class="ttdoc">Gracefully shutdown the connection and free associated data. </div></div>
<div class="ttc" id="structmbedtls__x509__crl_html"><div class="ttname"><a href="structmbedtls__x509__crl.html">mbedtls_x509_crl</a></div><div class="ttdef"><b>Definition:</b> <a href="x509__crl_8h_source.html#l00069">x509_crl.h:69</a></div></div>
<div class="ttc" id="ctr__drbg_8h_html_a70dbec5e03601bf437ec488f2645743b"><div class="ttname"><a href="ctr__drbg_8h.html#a70dbec5e03601bf437ec488f2645743b">mbedtls_ctr_drbg_init</a></div><div class="ttdeci">void mbedtls_ctr_drbg_init(mbedtls_ctr_drbg_context *ctx)</div><div class="ttdoc">CTR_DRBG context initialization Makes the context ready for mbedtls_ctr_drbg_seed() or mbedtls_ctr_dr...</div></div>
<div class="ttc" id="ssl_8h_html_afc2b6b55d7ccaf38d84a4fbf1655f426"><div class="ttname"><a href="ssl_8h.html#afc2b6b55d7ccaf38d84a4fbf1655f426">mbedtls_ssl_conf_verify</a></div><div class="ttdeci">void mbedtls_ssl_conf_verify(mbedtls_ssl_config *conf, int(*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *), void *p_vrfy)</div><div class="ttdoc">Set the verification callback (Optional). </div></div>
<div class="ttc" id="namespaceconf_html"><div class="ttname"><a href="namespaceconf.html">conf</a></div><div class="ttdef"><b>Definition:</b> <a href="conf_8py_source.html#l00001">conf.py:1</a></div></div>
<div class="ttc" id="net__sockets_8h_html_ac12c400864a5aad46666828ce2a089a4"><div class="ttname"><a href="net__sockets_8h.html#ac12c400864a5aad46666828ce2a089a4">mbedtls_net_connect</a></div><div class="ttdeci">int mbedtls_net_connect(mbedtls_net_context *ctx, const char *host, const char *port, int proto)</div><div class="ttdoc">Initiate a connection with host:port in the given protocol. </div></div>
<div class="ttc" id="config_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div><div class="ttdoc">Configuration options (set of defines) </div></div>
<div class="ttc" id="namespacegencsv_html_a3a1a90139c2c8ab1fca0ea8b1790b7b2"><div class="ttname"><a href="namespacegencsv.html#a3a1a90139c2c8ab1fca0ea8b1790b7b2">gencsv.filename</a></div><div class="ttdeci">filename</div><div class="ttdef"><b>Definition:</b> <a href="gencsv_8py_source.html#l00007">gencsv.py:7</a></div></div>
<div class="ttc" id="ctr__drbg_8h_html_af6e4dd295ae790a33128562dd01c79ab"><div class="ttname"><a href="ctr__drbg_8h.html#af6e4dd295ae790a33128562dd01c79ab">mbedtls_ctr_drbg_random</a></div><div class="ttdeci">int mbedtls_ctr_drbg_random(void *p_rng, unsigned char *output, size_t output_len)</div><div class="ttdoc">CTR_DRBG generate random. </div></div>
<div class="ttc" id="ssl_8h_html_afb44a7bdf71d0a1472db0c70596599cb"><div class="ttname"><a href="ssl_8h.html#afb44a7bdf71d0a1472db0c70596599cb">MBEDTLS_SSL_PRESET_DEFAULT</a></div><div class="ttdeci">#define MBEDTLS_SSL_PRESET_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00185">ssl.h:185</a></div></div>
<div class="ttc" id="structmbedtls__ssl__session_html_a47c7a9c3ca501024650129c095a5ce3e"><div class="ttname"><a href="structmbedtls__ssl__session.html#a47c7a9c3ca501024650129c095a5ce3e">mbedtls_ssl_session::peer_cert</a></div><div class="ttdeci">mbedtls_x509_crt * peer_cert</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00556">ssl.h:556</a></div></div>
<div class="ttc" id="entropy_8h_html_aa901e027093c6fe65dee5760db78aced"><div class="ttname"><a href="entropy_8h.html#aa901e027093c6fe65dee5760db78aced">mbedtls_entropy_init</a></div><div class="ttdeci">void mbedtls_entropy_init(mbedtls_entropy_context *ctx)</div><div class="ttdoc">Initialize the context. </div></div>
<div class="ttc" id="mbedtls_2repo_2include_2mbedtls_2debug_8h_html"><div class="ttname"><a href="mbedtls_2repo_2include_2mbedtls_2debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="entropy_8h_html"><div class="ttname"><a href="entropy_8h.html">entropy.h</a></div><div class="ttdoc">Entropy accumulator implementation. </div></div>
<div class="ttc" id="group__x509__module_html_ga8e096827f1240b8f8bc15d6a83593f22"><div class="ttname"><a href="group__x509__module.html#ga8e096827f1240b8f8bc15d6a83593f22">mbedtls_x509_crl_parse_file</a></div><div class="ttdeci">int mbedtls_x509_crl_parse_file(mbedtls_x509_crl *chain, const char *path)</div><div class="ttdoc">Load one or more CRLs and append them to the chained list. </div></div>
<div class="ttc" id="group__x509__module_html_gab33c1e4e20bea7ce536119f54a113c6b"><div class="ttname"><a href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a></div><div class="ttdeci">void mbedtls_x509_crt_free(mbedtls_x509_crt *crt)</div><div class="ttdoc">Unallocate all certificate data. </div></div>
<div class="ttc" id="ssl_8h_html_a2064e7d9ad950b5979d2d6bab6ddc739"><div class="ttname"><a href="ssl_8h.html#a2064e7d9ad950b5979d2d6bab6ddc739">MBEDTLS_SSL_IS_CLIENT</a></div><div class="ttdeci">#define MBEDTLS_SSL_IS_CLIENT</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00136">ssl.h:136</a></div></div>
<div class="ttc" id="net__sockets_8h_html"><div class="ttname"><a href="net__sockets_8h.html">net_sockets.h</a></div><div class="ttdoc">Network communication functions. </div></div>
<div class="ttc" id="structmbedtls__entropy__context_html"><div class="ttname"><a href="structmbedtls__entropy__context.html">mbedtls_entropy_context</a></div><div class="ttdoc">Entropy context structure. </div><div class="ttdef"><b>Definition:</b> <a href="entropy_8h_source.html#l00122">entropy.h:122</a></div></div>
<div class="ttc" id="ssl_8h_html_ac2c1b17128ead2df3082e27b603deb4c"><div class="ttname"><a href="ssl_8h.html#ac2c1b17128ead2df3082e27b603deb4c">mbedtls_ssl_close_notify</a></div><div class="ttdeci">int mbedtls_ssl_close_notify(mbedtls_ssl_context *ssl)</div><div class="ttdoc">Notify the peer that the connection is being closed. </div></div>
<div class="ttc" id="structmbedtls__net__context_html"><div class="ttname"><a href="structmbedtls__net__context.html">mbedtls_net_context</a></div><div class="ttdef"><b>Definition:</b> <a href="net__sockets_8h_source.html#l00065">net_sockets.h:65</a></div></div>
<div class="ttc" id="group__x509__module_html_gaeb19c3326889f9e493fbd605c1113b96"><div class="ttname"><a href="group__x509__module.html#gaeb19c3326889f9e493fbd605c1113b96">mbedtls_x509_crl_free</a></div><div class="ttdeci">void mbedtls_x509_crl_free(mbedtls_x509_crl *crl)</div><div class="ttdoc">Unallocate all CRL data. </div></div>
<div class="ttc" id="ssl_8h_html_a2dc104a181bcd11eafbbf7e6923978bc"><div class="ttname"><a href="ssl_8h.html#a2dc104a181bcd11eafbbf7e6923978bc">mbedtls_ssl_free</a></div><div class="ttdeci">void mbedtls_ssl_free(mbedtls_ssl_context *ssl)</div><div class="ttdoc">Free referenced items in an SSL context and clear memory. </div></div>
<div class="ttc" id="ssl_8h_html_a674bde213fbbf602e04bbc131dd2dc33"><div class="ttname"><a href="ssl_8h.html#a674bde213fbbf602e04bbc131dd2dc33">MBEDTLS_ERR_SSL_WANT_WRITE</a></div><div class="ttdeci">#define MBEDTLS_ERR_SSL_WANT_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00106">ssl.h:106</a></div></div>
<div class="ttc" id="entropy_8h_html_a81765f6cdf4e5111bcb9f4324f3234cb"><div class="ttname"><a href="entropy_8h.html#a81765f6cdf4e5111bcb9f4324f3234cb">mbedtls_entropy_func</a></div><div class="ttdeci">int mbedtls_entropy_func(void *data, unsigned char *output, size_t len)</div><div class="ttdoc">Retrieve entropy from the accumulator (Maximum length: MBEDTLS_ENTROPY_BLOCK_SIZE) (Thread-safe if MB...</div></div>
<div class="ttc" id="_s_e_g_g_e_r___r_t_t_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="_s_e_g_g_e_r___r_t_t_8c_source.html#l00114">SEGGER_RTT.c:114</a></div></div>
<div class="ttc" id="group__x509__module_html_ga571fc89b9f3217ab3dd67bd7af905066"><div class="ttname"><a href="group__x509__module.html#ga571fc89b9f3217ab3dd67bd7af905066">mbedtls_x509_crt_parse_path</a></div><div class="ttdeci">int mbedtls_x509_crt_parse_path(mbedtls_x509_crt *chain, const char *path)</div><div class="ttdoc">Load one or more certificate files from a path and add them to the chained list. Parses permissively...</div></div>
<div class="ttc" id="stdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00038">stdint.h:38</a></div></div>
<div class="ttc" id="net__sockets_8h_html_a4841afd0e14f1fd44b82c3a850961ab7"><div class="ttname"><a href="net__sockets_8h.html#a4841afd0e14f1fd44b82c3a850961ab7">mbedtls_net_send</a></div><div class="ttdeci">int mbedtls_net_send(void *ctx, const unsigned char *buf, size_t len)</div><div class="ttdoc">Write at most &amp;#39;len&amp;#39; characters. If no error occurs, the actual amount read is returned. </div></div>
<div class="ttc" id="ssl_8h_html_a8b7442420aef7f1a76fa8c5336362f9e"><div class="ttname"><a href="ssl_8h.html#a8b7442420aef7f1a76fa8c5336362f9e">mbedtls_ssl_set_bio</a></div><div class="ttdeci">void mbedtls_ssl_set_bio(mbedtls_ssl_context *ssl, void *p_bio, mbedtls_ssl_send_t *f_send, mbedtls_ssl_recv_t *f_recv, mbedtls_ssl_recv_timeout_t *f_recv_timeout)</div><div class="ttdoc">Set the underlying BIO callbacks for write, read and read-with-timeout. </div></div>
<div class="ttc" id="key__app_8c_html_a15d65445a8255b32e162d892f6627851"><div class="ttname"><a href="key__app_8c.html#a15d65445a8255b32e162d892f6627851">DFL_MODE</a></div><div class="ttdeci">#define DFL_MODE</div><div class="ttdef"><b>Definition:</b> <a href="key__app_8c_source.html#l00048">key_app.c:48</a></div></div>
<div class="ttc" id="ssl_8h_html_a469cd1c64bbba4be22347bf8874a017e"><div class="ttname"><a href="ssl_8h.html#a469cd1c64bbba4be22347bf8874a017e">mbedtls_ssl_conf_rng</a></div><div class="ttdeci">void mbedtls_ssl_conf_rng(mbedtls_ssl_config *conf, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</div><div class="ttdoc">Set the random number generator callback. </div></div>
<div class="ttc" id="ssl_8h_html_acf690cf4772ff3e2df4b8295275e6fc7"><div class="ttname"><a href="ssl_8h.html#acf690cf4772ff3e2df4b8295275e6fc7">MBEDTLS_SSL_TRANSPORT_STREAM</a></div><div class="ttdeci">#define MBEDTLS_SSL_TRANSPORT_STREAM</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00122">ssl.h:122</a></div></div>
<div class="ttc" id="ssl_8h_html_a8560dea66d7830a11874188727ec4c45"><div class="ttname"><a href="ssl_8h.html#a8560dea66d7830a11874188727ec4c45">mbedtls_ssl_init</a></div><div class="ttdeci">void mbedtls_ssl_init(mbedtls_ssl_context *ssl)</div><div class="ttdoc">Initialize an SSL context Just makes the context ready for mbedtls_ssl_setup() or mbedtls_ssl_free() ...</div></div>
<div class="ttc" id="ctr__drbg_8h_html_ad93d675f998550b4478c1fe6f4f34ebc"><div class="ttname"><a href="ctr__drbg_8h.html#ad93d675f998550b4478c1fe6f4f34ebc">mbedtls_ctr_drbg_seed</a></div><div class="ttdeci">int mbedtls_ctr_drbg_seed(mbedtls_ctr_drbg_context *ctx, int(*f_entropy)(void *, unsigned char *, size_t), void *p_entropy, const unsigned char *custom, size_t len)</div><div class="ttdoc">CTR_DRBG initial seeding Seed and setup entropy source for future reseeds. </div></div>
<div class="ttc" id="ssl_8h_html_ab15dcbe7c7fe2a5c118e7c486c07c921"><div class="ttname"><a href="ssl_8h.html#ab15dcbe7c7fe2a5c118e7c486c07c921">mbedtls_ssl_conf_dbg</a></div><div class="ttdeci">void mbedtls_ssl_conf_dbg(mbedtls_ssl_config *conf, void(*f_dbg)(void *, int, const char *, int, const char *), void *p_dbg)</div><div class="ttdoc">Set the debug callback. </div></div>
<div class="ttc" id="ssl_8h_html_aba55bcda50a47e83803e31a8db7c9a86"><div class="ttname"><a href="ssl_8h.html#aba55bcda50a47e83803e31a8db7c9a86">mbedtls_ssl_config_init</a></div><div class="ttdeci">void mbedtls_ssl_config_init(mbedtls_ssl_config *conf)</div><div class="ttdoc">Initialize an SSL configuration context Just makes the context ready for mbedtls_ssl_config_defaults(...</div></div>
<div class="ttc" id="group__x509__module_html_ga8513a192e281217802837571da98e218"><div class="ttname"><a href="group__x509__module.html#ga8513a192e281217802837571da98e218">mbedtls_x509_crl_init</a></div><div class="ttdeci">void mbedtls_x509_crl_init(mbedtls_x509_crl *crl)</div><div class="ttdoc">Initialize a CRL (chain) </div></div>
<div class="ttc" id="x509_8h_html"><div class="ttname"><a href="x509_8h.html">x509.h</a></div><div class="ttdoc">X.509 generic defines and structures. </div></div>
<div class="ttc" id="net__sockets_8h_html_aed7458e19fc1b4794f3a23aa3df49543"><div class="ttname"><a href="net__sockets_8h.html#aed7458e19fc1b4794f3a23aa3df49543">mbedtls_net_init</a></div><div class="ttdeci">void mbedtls_net_init(mbedtls_net_context *ctx)</div><div class="ttdoc">Initialize a context Just makes the context ready to be used or freed safely. </div></div>
<div class="ttc" id="entropy_8h_html_a06778439f8a0e2daa2d3b444e06ad8dd"><div class="ttname"><a href="entropy_8h.html#a06778439f8a0e2daa2d3b444e06ad8dd">mbedtls_entropy_free</a></div><div class="ttdeci">void mbedtls_entropy_free(mbedtls_entropy_context *ctx)</div><div class="ttdoc">Free the data in the context. </div></div>
<div class="ttc" id="group__x509__module_html_gabaf30f2269fc3b6608b25871f9d09da6"><div class="ttname"><a href="group__x509__module.html#gabaf30f2269fc3b6608b25871f9d09da6">mbedtls_x509_crt_info</a></div><div class="ttdeci">int mbedtls_x509_crt_info(char *buf, size_t size, const char *prefix, const mbedtls_x509_crt *crt)</div><div class="ttdoc">Returns an informational string about the certificate. </div></div>
<div class="ttc" id="cert__app_8c_html_a840291bc02cba5474a4cb46a9b9566fe"><div class="ttname"><a href="cert__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a></div><div class="ttdeci">int main(void)</div><div class="ttdef"><b>Definition:</b> <a href="cert__app_8c_source.html#l00044">cert_app.c:44</a></div></div>
<div class="ttc" id="group__x509__module_html_gad4da63133d3590aa311488497d4c38ec"><div class="ttname"><a href="group__x509__module.html#gad4da63133d3590aa311488497d4c38ec">mbedtls_x509_crt_parse_file</a></div><div class="ttdeci">int mbedtls_x509_crt_parse_file(mbedtls_x509_crt *chain, const char *path)</div><div class="ttdoc">Load one or more certificates and add them to the chained list. Parses permissively. If some certificates can be parsed, the result is the number of failed certificates it encountered. If none complete correctly, the first error is returned. </div></div>
<div class="ttc" id="ssl_8h_html_af79cb539a0ee6ac20cf9c574f4c3b343"><div class="ttname"><a href="ssl_8h.html#af79cb539a0ee6ac20cf9c574f4c3b343">mbedtls_ssl_setup</a></div><div class="ttdeci">int mbedtls_ssl_setup(mbedtls_ssl_context *ssl, const mbedtls_ssl_config *conf)</div><div class="ttdoc">Set up an SSL context for use. </div></div>
<div class="ttc" id="structmbedtls__ssl__config_html"><div class="ttname"><a href="structmbedtls__ssl__config.html">mbedtls_ssl_config</a></div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00582">ssl.h:582</a></div></div>
<div class="ttc" id="structmbedtls__x509__crt_html"><div class="ttname"><a href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a></div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00052">x509_crt.h:52</a></div></div>
<div class="ttc" id="ssl_8h_html_acc9ad7a06d7c65260e815a3187a5fb37"><div class="ttname"><a href="ssl_8h.html#acc9ad7a06d7c65260e815a3187a5fb37">MBEDTLS_SSL_VERIFY_REQUIRED</a></div><div class="ttdeci">#define MBEDTLS_SSL_VERIFY_REQUIRED</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00153">ssl.h:153</a></div></div>
<div class="ttc" id="ssl_8h_html_a7655f025440a6c5ccd4fc13832abb1dd"><div class="ttname"><a href="ssl_8h.html#a7655f025440a6c5ccd4fc13832abb1dd">mbedtls_ssl_config_free</a></div><div class="ttdeci">void mbedtls_ssl_config_free(mbedtls_ssl_config *conf)</div><div class="ttdoc">Free an SSL configuration context. </div></div>
<div class="ttc" id="ssl_8h_html"><div class="ttname"><a href="ssl_8h.html">ssl.h</a></div><div class="ttdoc">SSL/TLS functions. </div></div>
<div class="ttc" id="group__x509__module_html_ga016dd06bc770e77b84005f305df20ed1"><div class="ttname"><a href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a></div><div class="ttdeci">void mbedtls_x509_crt_init(mbedtls_x509_crt *crt)</div><div class="ttdoc">Initialize a certificate (chain) </div></div>
<div class="ttc" id="ssl_8h_html_aa1335b65ba57e81accc91ef95454d5a6"><div class="ttname"><a href="ssl_8h.html#aa1335b65ba57e81accc91ef95454d5a6">mbedtls_ssl_config_defaults</a></div><div class="ttdeci">int mbedtls_ssl_config_defaults(mbedtls_ssl_config *conf, int endpoint, int transport, int preset)</div><div class="ttdoc">Load reasonnable default SSL configuration values. (You need to call mbedtls_ssl_config_init() first...</div></div>
<div class="ttc" id="ssl_8h_html_a85c3bb6b682ba361d13de1c0a1eb69fb"><div class="ttname"><a href="ssl_8h.html#a85c3bb6b682ba361d13de1c0a1eb69fb">mbedtls_ssl_conf_ca_chain</a></div><div class="ttdeci">void mbedtls_ssl_conf_ca_chain(mbedtls_ssl_config *conf, mbedtls_x509_crt *ca_chain, mbedtls_x509_crl *ca_crl)</div><div class="ttdoc">Set the data required to verify peer certificate. </div></div>
<div class="ttc" id="ssl_8h_html_a4a37e497cd08c896870a42b1b618186e"><div class="ttname"><a href="ssl_8h.html#a4a37e497cd08c896870a42b1b618186e">mbedtls_ssl_handshake</a></div><div class="ttdeci">int mbedtls_ssl_handshake(mbedtls_ssl_context *ssl)</div><div class="ttdoc">Perform the SSL handshake. </div></div>
<div class="ttc" id="group__x509__module_html_gae88f1d8e6696eb2beeffe0a708219e6b"><div class="ttname"><a href="group__x509__module.html#gae88f1d8e6696eb2beeffe0a708219e6b">mbedtls_x509_crt_verify_info</a></div><div class="ttdeci">int mbedtls_x509_crt_verify_info(char *buf, size_t size, const char *prefix, uint32_t flags)</div><div class="ttdoc">Returns an informational string about the verification status of a certificate. </div></div>
<div class="ttc" id="structmbedtls__x509__crt_html_acb677316e4c036e738ed05833f222f5a"><div class="ttname"><a href="structmbedtls__x509__crt.html#acb677316e4c036e738ed05833f222f5a">mbedtls_x509_crt::next</a></div><div class="ttdeci">struct mbedtls_x509_crt * next</div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00092">x509_crt.h:92</a></div></div>
<div class="ttc" id="mbedtls_2repo_2include_2mbedtls_2debug_8h_html_a6629362e96b43725ace95c8ff01d9985"><div class="ttname"><a href="mbedtls_2repo_2include_2mbedtls_2debug_8h.html#a6629362e96b43725ace95c8ff01d9985">mbedtls_debug_set_threshold</a></div><div class="ttdeci">void mbedtls_debug_set_threshold(int threshold)</div><div class="ttdoc">Set the threshold error level to handle globally all debug output. Debug messages that have a level o...</div></div>
<div class="ttc" id="structmbedtls__ssl__context_html"><div class="ttname"><a href="structmbedtls__ssl__context.html">mbedtls_ssl_context</a></div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00755">ssl.h:755</a></div></div>
<div class="ttc" id="ssl_8h_html_a5695285c9dbfefec295012b566290f37"><div class="ttname"><a href="ssl_8h.html#a5695285c9dbfefec295012b566290f37">mbedtls_ssl_conf_authmode</a></div><div class="ttdeci">void mbedtls_ssl_conf_authmode(mbedtls_ssl_config *conf, int authmode)</div><div class="ttdoc">Set the certificate verification mode Default: NONE on server, REQUIRED on client. </div></div>
<div class="ttc" id="ssl_8h_html_aa659024cf89e20d6d2248c0626db7ef2"><div class="ttname"><a href="ssl_8h.html#aa659024cf89e20d6d2248c0626db7ef2">mbedtls_ssl_set_hostname</a></div><div class="ttdeci">int mbedtls_ssl_set_hostname(mbedtls_ssl_context *ssl, const char *hostname)</div><div class="ttdoc">Set the hostname to check against the received server certificate. It sets the ServerName TLS extensi...</div></div>
<div class="ttc" id="key__app_8c_html_a5788fa2aa47c6468f29c31c2bd7d7488"><div class="ttname"><a href="key__app_8c.html#a5788fa2aa47c6468f29c31c2bd7d7488">DFL_DEBUG_LEVEL</a></div><div class="ttdeci">#define DFL_DEBUG_LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="key__app_8c_source.html#l00052">key_app.c:52</a></div></div>
<div class="ttc" id="cert__app_8c_html_a6d045f0c3699e1eac7f723054dc8b3e4"><div class="ttname"><a href="cert__app_8c.html#a6d045f0c3699e1eac7f723054dc8b3e4">mbedtls_fprintf</a></div><div class="ttdeci">#define mbedtls_fprintf</div><div class="ttdef"><b>Definition:</b> <a href="cert__app_8c_source.html#l00035">cert_app.c:35</a></div></div>
<div class="ttc" id="third__party_2mbedtls_2repo_2include_2mbedtls_2platform_8h_html"><div class="ttname"><a href="third__party_2mbedtls_2repo_2include_2mbedtls_2platform_8h.html">platform.h</a></div></div>
<div class="ttc" id="ssl_8h_html_a67a1e093cf042831aa60bb567915b560"><div class="ttname"><a href="ssl_8h.html#a67a1e093cf042831aa60bb567915b560">MBEDTLS_ERR_SSL_WANT_READ</a></div><div class="ttdeci">#define MBEDTLS_ERR_SSL_WANT_READ</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00105">ssl.h:105</a></div></div>
<div class="ttc" id="net__sockets_8h_html_a03af351ec420bbeb5e91357abcfb3663"><div class="ttname"><a href="net__sockets_8h.html#a03af351ec420bbeb5e91357abcfb3663">mbedtls_net_recv</a></div><div class="ttdeci">int mbedtls_net_recv(void *ctx, unsigned char *buf, size_t len)</div><div class="ttdoc">Read at most &amp;#39;len&amp;#39; characters. If no error occurs, the actual amount read is returned. </div></div>
<div class="ttc" id="ctr__drbg_8h_html"><div class="ttname"><a href="ctr__drbg_8h.html">ctr_drbg.h</a></div><div class="ttdoc">CTR_DRBG based on AES-256 (NIST SP 800-90) </div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 15 2017 18:32:27 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
